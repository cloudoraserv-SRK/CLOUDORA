<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cloudora â€“ Lead Filters</title>

<link rel="stylesheet" href="../../style.css">

<style>
    body { background:#eef2f7; font-family:Arial; margin:0; padding:20px; }

    .lf-header { background:#0d6efd; color:white; padding:12px 20px; font-size:20px;
        border-radius:8px; display:flex; gap:12px; align-items:center; }

    .back-btn { background:white; border:none; padding:6px 12px; border-radius:6px; cursor:pointer; }

    .filter-box {
        background:white; padding:20px; border-radius:10px; margin-top:20px;
        box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }

    .filter-grid {
        display:grid; grid-template-columns:repeat(3,1fr); gap:15px;
    }

    input, select {
        padding:8px; width:100%; border:1px solid #ccc; border-radius:6px;
    }

    .search-btn {
        background:#0d6efd; color:white; padding:10px 16px; border:none;
        border-radius:6px; margin-top:15px; cursor:pointer;
    }

    table {
        width:100%; background:white; margin-top:20px; border-collapse:collapse;
        border-radius:8px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.15);
    }

    th, td { padding:12px; border-bottom:1px solid #ddd; }

    th { background:#0d6efd; color:white; cursor:pointer; position:relative; }

    tr:hover { background:#f6f9ff; }

    .filter-menu {
        position:absolute; top:40px; left:0; width:200px; background:white;
        border:1px solid #ccc; border-radius:8px; padding:10px; display:none;
        z-index:9999; max-height:250px; overflow:auto;
    }

    .assign-btn {
        background:#28a745; color:white; padding:10px 16px;
        border:none; border-radius:6px; cursor:pointer;
        margin-top:15px; display:none;
    }

    /* Popup */
    .popup { position:fixed; top:0; left:0; width:100%; height:100%;
        background:rgba(0,0,0,0.5); display:none; justify-content:center; align-items:center; }

    .popup-content {
        background:white; width:400px; padding:25px; border-radius:10px;
        box-shadow:0 2px 10px rgba(0,0,0,0.3);
    }

    .popup-close { float:right; background:red; color:white; padding:4px 8px;
        border:none; border-radius:4px; cursor:pointer; }
</style>
</head>

<body>

<header class="lf-header">
    <button class="back-btn" onclick="goBack()">â¬… Back</button>
    <span>Cloudora Lead Filters</span>
</header>

<div class="filter-box">

    <h3>Filter Leads</h3>

    <div class="filter-grid">
        <div>
            <label>Category</label>
            <input id="fCategory" placeholder="e.g. ecommerce, hospital">
        </div>

        <div>
            <label>City</label>
            <input id="fCity" placeholder="e.g. Mumbai, Dubai">
        </div>

        <div>
            <label>Country</label>
            <input id="fCountry" placeholder="e.g. India">
        </div>

        <div>
            <label>Freshness</label>
            <select id="fFreshness">
                <option value="all">All</option>
                <option value="1">Last 24 hours</option>
                <option value="7">Last 7 days</option>
                <option value="30">Last 30 days</option>
            </select>
        </div>

        <div>
            <label>Assigned</label>
            <select id="fAssigned">
                <option value="any">Any</option>
                <option value="unassigned">Unassigned Only</option>
                <option value="me">Assigned to Me</option>
            </select>
        </div>
    </div>

    <button class="search-btn" onclick="searchLeads()">ðŸ”Ž Search</button>
</div>


<h3 id="resultCount" style="margin-top:20px;"></h3>

<table style="display:none;" id="leadTable">
    <thead>
        <tr>
            <th><input type="checkbox" onclick="toggleSelectAll(this)"> Select</th>

            <th onclick="sortBy('name')">Name â–¼</th>
            <th onclick="sortBy('phone')">Phone â–¼</th>
            <th onclick="sortBy('website')">Website â–¼</th>

            <th>
                Category â–¼
                <div id="category-filter" class="filter-menu"></div>
            </th>

            <th>
                City â–¼
                <div id="city-filter" class="filter-menu"></div>
            </th>
        </tr>
    </thead>

    <tbody id="leadList"></tbody>
</table>

<button id="assignBtn" class="assign-btn" onclick="assignSelected()">Assign Selected</button>


<!-- POPUP -->
<div id="leadPopup" class="popup">
    <div class="popup-content">
        <button class="popup-close" onclick="closePopup()">âœ–</button>

        <h2 id="pName"></h2>
        <p><b>Phone:</b> <span id="pPhone"></span></p>
        <p><b>Email:</b> <span id="pEmail"></span></p>
        <p><b>City:</b> <span id="pCity"></span></p>
        <p><b>Country:</b> <span id="pCountry"></span></p>
        <p><b>Category:</b> <span id="pCategory"></span></p>
        <p><b>Website:</b> <a id="pWebsite" target="_blank">Visit</a></p>
    </div>
</div>

<script src="../../api/supabase.min.js"></script>
<script src="../../global.js"></script>
<script src="./lead-filters.js"></script>


</body>
</html>
